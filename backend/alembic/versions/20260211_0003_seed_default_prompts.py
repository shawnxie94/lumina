"""seed built-in default prompts

Revision ID: 20260211_0003
Revises: 20260210_0002
Create Date: 2026-02-11 19:30:00

"""

from __future__ import annotations

from datetime import date
import uuid

from alembic import op
from sqlalchemy import text

# revision identifiers, used by Alembic.
revision = "20260211_0003"
down_revision = "20260210_0002"
branch_labels = None
depends_on = None


DEFAULT_PROMPT_CONFIGS = [
    {
        "name": "é»˜è®¤-å¿«è¯»æ‘˜è¦",
        "type": "summary",
        "prompt": """ä¸ºæä¾›çš„æ–‡æœ¬åˆ›ä½œä¸€ä»½â€œå¿«è¯»æ‘˜è¦â€ï¼Œæ—¨åœ¨è®©è¯»è€…åœ¨30ç§’å†…æŽŒæ¡æ ¸å¿ƒæƒ…æŠ¥ã€‚

è¦æ±‚ï¼š
1) æžç®€ä¸»ä¹‰ï¼šå‰”é™¤èƒŒæ™¯é“ºåž«ã€æ¡ˆä¾‹ç»†èŠ‚ã€è¥é”€è¯æœ¯åŠä¿®é¥°æ€§è¯æ±‡ï¼Œç›´å¥”ä¸»é¢˜ã€‚
2) å†…å®¹å¯†åº¦ï¼šå¿…é¡»åŒ…å«æ ¸å¿ƒä¸»ä½“ã€å…³é”®åŠ¨ä½œ/äº‹ä»¶ã€æœ€ç»ˆå½±å“/ç»“è®ºã€‚
3) ç¯‡å¹…ï¼šä¸¥æ ¼æŽ§åˆ¶åœ¨50-150å­—ä¹‹é—´ã€‚

å¾…æ‘˜è¦å†…å®¹ï¼š
{content}""",
        "system_prompt": "ä½ æ˜¯ä¸€åèµ„æ·±å†…å®¹åˆ†æžå¸ˆï¼Œæ“…é•¿ç”¨æœ€æžç®€çš„è¯­è¨€ç²¾å‡†æ•æ‰æ–‡ç« çµé­‚ã€‚è¾“å‡ºå¿…é¡»ä¸ºä¸­æ–‡ã€å®¢è§‚ã€å•æ®µé•¿å¥ï¼ˆå¯ç”¨é€—å·ã€å¥å·ï¼Œç¦æ­¢åˆ†æ®µ/æ¢è¡Œï¼‰ï¼Œç¦æ­¢ä»»ä½•åˆ—è¡¨ç¬¦å·ï¼ˆ- * 1.ç­‰ï¼‰ï¼Œç¦æ­¢å‡ºçŽ°â€œè¿™ç¯‡æ–‡ç« è®²äº†/æ‘˜è¦å¦‚ä¸‹â€ç­‰å‰ç½®åºŸè¯ã€‚",
        "response_format": "text",
        "temperature": 0.3,
        "max_tokens": 400,
        "top_p": 1.0,
    },
    {
        "name": "é»˜è®¤-æ€»ç»“",
        "type": "key_points",
        "prompt": """è¯·é˜…è¯»æä¾›çš„æ–‡æœ¬å†…å®¹ï¼Œç”Ÿæˆä¸€ä»½å¹²ç»ƒã€å®¢è§‚çš„ä¸­æ–‡æ€»ç»“ã€‚

è¦æ±‚ï¼š
1) å½»åº•åŽ»å™ªï¼šå‰”é™¤è¥é”€æŽ¨å¹¿ã€æ‹›è˜ä¿¡æ¯ã€è¯¾ç¨‹å®£ä¼ ã€å…è´£å£°æ˜Žã€ç¤¾äº¤åª’ä½“å¼•å¯¼è¯­ç­‰æ— å…³å†…å®¹ã€‚
2) èšç„¦æ ¸å¿ƒï¼šåªä¿ç•™æ ¸å¿ƒè§‚ç‚¹ã€å…³é”®äº‹å®žä¸Žé‡è¦ç»“è®ºã€‚
3) é€»è¾‘é‡æž„ï¼šä¸è¦æ‘˜æŠ„åŽŸå¥ï¼Œé‡ç»„è¯­è¨€ï¼Œä¿¡æ¯å¯†åº¦é«˜ã€è¡Œæ–‡è¿žè´¯ã€‚
4) æ®µè½è¡”æŽ¥ï¼šæ®µè½å†…è‡ªç„¶è¡”æŽ¥ï¼ˆå¯ç”¨"æ­¤å¤–/å¦ä¸€æ–¹é¢/ç»¼ä¸Šæ‰€è¿°"ç­‰è¿žæŽ¥è¯ï¼‰ã€‚
5) æ ¼å¼å¼ºåŒ–ï¼šå–„ç”¨ Markdown æ ¼å¼çªå‡ºå…³é”®ä¿¡æ¯ï¼Œå…·ä½“è§„åˆ™å¦‚ä¸‹ï¼š
   - **åŠ ç²—**ï¼šç”¨äºŽæ ¸å¿ƒæ¦‚å¿µã€å…³é”®æœ¯è¯­ã€é‡è¦äººå/æœºæž„åã€å…³é”®æ•°æ®ï¼ˆå¦‚"**GDP å¢žé•¿ 5.2%**"ã€"**OpenAI**"ï¼‰ã€‚
   - *æ–œä½“*ï¼šç”¨äºŽéœ€è¦ç‰¹åˆ«åŒºåˆ†æˆ–å­˜åœ¨äº‰è®®/ä¸ç¡®å®šæ€§çš„è¡¨è¿°ï¼ˆå¦‚"*æ®æœªç»è¯å®žçš„æ¶ˆæ¯*"ã€"*è¯¥è§‚ç‚¹å°šå­˜åˆ†æ­§*"ï¼‰ï¼Œä¹Ÿå¯ç”¨äºŽå¯¹æ¯”åœºæ™¯ä¸­æ ‡æ³¨å¯¹ç«‹é¢ã€‚
   - **åŠ ç²— + æ–œä½“ç»“åˆ**ï¼ˆ***æ–‡å­—***ï¼‰ï¼šä»…ç”¨äºŽå…¨æ–‡æœ€æ ¸å¿ƒçš„ç»“è®ºæˆ–è½¬æŠ˜æ€§åˆ¤æ–­ï¼Œä¸è¶…è¿‡ 1â€“2 å¤„ã€‚

å­—æ•°ï¼š300â€“500 å­—ã€‚

å¾…æ€»ç»“å†…å®¹ï¼š
{content}
""",
        "system_prompt": "ä½ æ˜¯ä¸€åèµ„æ·±å†…å®¹åˆ†æžå¸ˆï¼Œæ“…é•¿ä»Žå¤æ‚ä¿¡æ¯ä¸­å‰¥ç¦»å™ªéŸ³ï¼Œæå–æ ¸å¿ƒä»·å€¼å¹¶è¿›è¡Œä¸“ä¸šé‡æž„ã€‚è¾“å‡ºå¿…é¡»ä¸ºä¸­æ–‡ã€å®¢è§‚ã€æ— ä¸»è§‚è¯„ä»·ï¼›ç¦æ­¢ä»»ä½•å¼€åœºç™½/ç»“æŸè¯­æˆ–è§£é‡Šæ€§æ–‡å­—ï¼›ä¸¥ç¦ä½¿ç”¨ä»»ä½•åˆ—è¡¨ç¬¦å·ï¼›æ®µè½æ•°é‡ä¸¥æ ¼æŽ§åˆ¶åœ¨2-3æ®µã€‚",
        "response_format": "text",
        "temperature": 0.4,
        "max_tokens": 1000,
        "top_p": 0.9,
    },
    {
        "name": "é»˜è®¤-ä¸­è‹±ç¿»è¯‘",
        "type": "translation",
        "prompt": """å°†è¾“å…¥çš„è‹±æ–‡æ–‡ç« ç¿»è¯‘æˆä¸­æ–‡ã€‚

è¦æ±‚ï¼š
1) ä¸¥æ ¼ä¿ç•™åŽŸå§‹ Markdown æ ¼å¼ï¼ˆæ ‡é¢˜ã€åˆ—è¡¨ã€é“¾æŽ¥ã€ä»£ç å—ã€æ¢è¡Œç­‰ï¼‰ã€‚
2) ä¸“ä¸šæœ¯è¯­ä½¿ç”¨ä¸šç•Œé€šç”¨ä¸­æ–‡è¡¨è¾¾ï¼Œå¿…è¦æ—¶å¯åœ¨ä¸­æ–‡åŽä¿ç•™è‹±æ–‡åŽŸè¯ã€‚
3) è¯­è¨€é£Žæ ¼åœ°é“ã€é€šé¡ºï¼Œé¿å…ç¿»è¯‘è…”ã€‚
4) åªè¾“å‡ºè¯‘æ–‡ï¼Œä¸è¦å‰åŽç¼€ã€‚

è¯·ç›´æŽ¥å¼€å§‹ç¿»è¯‘ï¼š
{content}""",
        "system_prompt": "ä½ æ˜¯ä¸€ä½ç²¾é€šä¸­è‹±æ–‡äº’è¯‘çš„ä¸“ä¸šç¿»è¯‘å®˜ï¼Œæ“…é•¿ç§‘æŠ€ã€æ–‡åŒ–åŠå•†ä¸šé¢†åŸŸçš„ä¿¡è¾¾é›…ç¿»è¯‘ã€‚å¿…é¡»ä»…è¾“å‡ºä¸­æ–‡è¯‘æ–‡ï¼Œç¦æ­¢ä»»ä½•é¢å¤–è¯è¯­ã€‚",
        "response_format": "text",
        "temperature": 0.2,
        "max_tokens": 14000,
        "top_p": 1.0,
    },
    {
        "name": "é»˜è®¤-å¤§çº²",
        "type": "outline",
        "prompt": """è¯·é˜…è¯»æä¾›çš„æ–‡æœ¬ï¼Œå¹¶æŒ‰æŒ‡å®š JSON ç»“æž„æå–æ–‡ç« å¤§çº²ï¼ˆæ€ç»´å¯¼å›¾å‹å¥½ç‰ˆï¼‰ã€‚

è¦æ±‚ï¼š
1) æ ¹èŠ‚ç‚¹ title ç®€æ´æ¦‚æ‹¬ä¸»é¢˜ï¼Œå¯é™„é¢†åŸŸ/å¯¹è±¡ï¼ˆå¦‚â€œå¢žé•¿ç­–ç•¥ï½œSaaSâ€ï¼‰ã€‚
2) æ ¸å¿ƒè§‚ç‚¹ï¼š2-3 ä¸ªä¸»è¦ç«‹è®ºã€‚
3) å…³é”®æ¦‚å¿µï¼šç”¨â€œæ¦‚å¿µï¼šæžç®€é‡Šä¹‰â€æ ¼å¼ã€‚
4) ç»“è®ºä¸Žå¯ç¤ºï¼šè¾“å‡ºç»“è®ºä¸Žå¯ç¤ºï¼›å¦‚æœ‰æ˜Žç¡®è¡ŒåŠ¨å»ºè®®ï¼Œå¯é¢å¤–å¢žåŠ â€œè¡ŒåŠ¨ï¼š...â€èŠ‚ç‚¹ã€‚
5) å¶å­èŠ‚ç‚¹ä¸è¦ä½¿ç”¨â€œè§‚ç‚¹A/æ¦‚å¿µ1â€ç­‰å‰ç¼€ï¼Œç›´æŽ¥ç»™å†…å®¹ã€‚
6) å¶å­èŠ‚ç‚¹å»ºè®®ä¸è¶…è¿‡ 30 å­—ï¼Œä¾¿äºŽç¼©ç•¥å›¾å±•ç¤ºã€‚

è¾“å‡ºç»“æž„ï¼ˆåªæ›¿æ¢å†…å®¹ï¼‰ï¼š
{
  "title": "æ–‡ç« æ ‡é¢˜",
  "children": [
    {
      "title": "æ ¸å¿ƒè§‚ç‚¹",
      "children": [
        { "title": "æ ¸å¿ƒè§‚ç‚¹å†…å®¹" },
        { "title": "æ ¸å¿ƒè§‚ç‚¹å†…å®¹" }
      ]
    },
    {
      "title": "å…³é”®æ¦‚å¿µ",
      "children": [
        { "title": "æ¦‚å¿µï¼šæžç®€é‡Šä¹‰" },
        { "title": "æ¦‚å¿µï¼šæžç®€é‡Šä¹‰" }
      ]
    },
    {
      "title": "ç»“è®ºä¸Žå¯ç¤º",
      "children": [
        { "title": "ç»“è®ºï¼š..." },
        { "title": "å¯ç¤ºï¼š..." },
        { "title": "è¡ŒåŠ¨ï¼š..." }
      ]
    }
  ]
}

å¾…è§£æžå†…å®¹ï¼š
{content}
""",
        "system_prompt": "ä½ æ˜¯ä¸€åç»“æž„åŒ–æ•°æ®è½¬æ¢ä¸“å®¶ï¼Œæ“…é•¿å°†é•¿ç¯‡æ–‡ç« è§£æžä¸ºæ€ç»´å¯¼å›¾ä¸“ç”¨çš„ JSON æ ¼å¼ã€‚è¾“å‡ºå¿…é¡»ä¸ºåˆæ³• JSONï¼Œç¦æ­¢ä»»ä½•è§£é‡Šæ€§æ–‡å­—ã€å¼€åœºç™½ã€Markdown ä»£ç å—ã€‚",
        "response_format": "json_object",
        "temperature": 0.3,
        "max_tokens": 1200,
        "top_p": 1.0,
    },
    {
        "name": "é»˜è®¤-å¹²ç»ƒæ€»ç»“",
        "type": "summary_long",
        "prompt": """è¯·é˜…è¯»æä¾›çš„æ–‡æœ¬å†…å®¹ï¼Œç”Ÿæˆä¸€ä»½å¹²ç»ƒã€å®¢è§‚çš„ä¸­æ–‡æ€»ç»“ã€‚

è¦æ±‚ï¼š
1) å½»åº•åŽ»å™ªï¼šå‰”é™¤è¥é”€æŽ¨å¹¿ã€æ‹›è˜ä¿¡æ¯ã€è¯¾ç¨‹å®£ä¼ ã€å…è´£å£°æ˜Žã€ç¤¾äº¤åª’ä½“å¼•å¯¼è¯­ç­‰æ— å…³å†…å®¹ã€‚
2) èšç„¦æ ¸å¿ƒï¼šåªä¿ç•™æ ¸å¿ƒè§‚ç‚¹ã€å…³é”®äº‹å®žä¸Žé‡è¦ç»“è®ºã€‚
3) é€»è¾‘é‡æž„ï¼šä¸è¦æ‘˜æŠ„åŽŸå¥ï¼Œé‡ç»„è¯­è¨€ï¼Œä¿¡æ¯å¯†åº¦é«˜ã€è¡Œæ–‡è¿žè´¯ã€‚
4) æ®µè½å†…è‡ªç„¶è¡”æŽ¥ï¼ˆå¯ç”¨â€œæ­¤å¤–/å¦ä¸€æ–¹é¢/ç»¼ä¸Šæ‰€è¿°â€ç­‰è¿žæŽ¥è¯ï¼‰ã€‚

å­—æ•°ï¼š300â€“500å­—ã€‚

å¾…æ€»ç»“å†…å®¹ï¼š
{content}""",
        "system_prompt": "ä½ æ˜¯ä¸€åèµ„æ·±å†…å®¹åˆ†æžå¸ˆï¼Œæ“…é•¿ä»Žå¤æ‚ä¿¡æ¯ä¸­å‰¥ç¦»å™ªéŸ³ï¼Œæå–æ ¸å¿ƒä»·å€¼å¹¶è¿›è¡Œä¸“ä¸šé‡æž„ã€‚è¾“å‡ºå¿…é¡»ä¸ºä¸­æ–‡ã€å®¢è§‚ã€æ— ä¸»è§‚è¯„ä»·ï¼›ç¦æ­¢ä»»ä½•å¼€åœºç™½/ç»“æŸè¯­æˆ–è§£é‡Šæ€§æ–‡å­—ï¼›ä¸¥ç¦ä½¿ç”¨ä»»ä½•åˆ—è¡¨ç¬¦å·ï¼›æ®µè½æ•°é‡ä¸¥æ ¼æŽ§åˆ¶åœ¨2-3æ®µã€‚",
        "response_format": "text",
        "temperature": 0.4,
        "max_tokens": 1000,
        "top_p": 0.9,
    },
    {
        "name": "é»˜è®¤-é‡‘å¥",
        "type": "quotes",
        "prompt": """è¯·é˜…è¯»æä¾›çš„æ–‡æœ¬å†…å®¹ï¼Œä»Žä¸­ç­›é€‰å¹¶æç‚¼å‡ºæœ€å…·æœ‰ä¼ æ’­åŠ›ã€æ·±åº¦æˆ–å¯å‘æ€§çš„é‡‘å¥ã€‚

è¦æ±‚ï¼š
1) æ ‡å‡†ï¼šæ·±åˆ»æ€§ã€å…±é¸£æ„Ÿã€ç²¾ç‚¼æ€§ã€‚
2) æ‹’ç»å¹³åº¸ï¼šä¸è¦äº‹å®žé™ˆè¿°å¥ï¼Œé€‰æ‹©è§‚ç‚¹å¥/ç»“è®ºå¥/ä¿®è¾žä¼˜ç¾Žçš„å¥å­ã€‚
3) å…è®¸æ¶¦è‰²ï¼šå¯åœ¨ä¸æ”¹å˜åŽŸæ„ä¸‹å¾®è°ƒï¼Œä½¿å…¶æ›´åƒç‹¬ç«‹åè¨€ã€‚
4) å¤šæ ·åŒ–ï¼šè¦†ç›–ä¸åŒç»´åº¦ï¼ˆè¶‹åŠ¿åˆ¤æ–­/ä»·å€¼åšå®ˆ/è¡ŒåŠ¨å·å¬ç­‰ï¼‰ã€‚

è¾“å‡ºæ ¼å¼ï¼š
- ä½¿ç”¨æ— åºåˆ—è¡¨ï¼ˆ-ï¼‰ï¼Œæ¯å¥å•ç‹¬ä¸€è¡Œ
- æ•°é‡ 3-5 æ¡
- ä»…è¾“å‡ºé‡‘å¥åˆ—è¡¨ï¼Œä¸è¦è§£é‡Š

å¾…æç‚¼å†…å®¹ï¼š
{content}""",
        "system_prompt": "ä½ æ˜¯ä¸€åèµ„æ·±æ–‡æ¡ˆé‡‘å¥æ•æ‰‹ï¼Œæ“…é•¿ä»Žé•¿ç¯‡å†…å®¹ä¸­æç‚¼ä¼ æ’­åŠ›å¼ºçš„é‡‘å¥ã€‚è¾“å‡ºå¿…é¡»ä¸ºä¸­æ–‡ï¼Œä»…è¾“å‡ºé‡‘å¥åˆ—è¡¨ï¼Œä¸è¦ä»»ä½•è§£é‡Šæˆ–å‰åŽç¼€ã€‚",
        "response_format": "text",
        "temperature": 0.7,
        "max_tokens": 700,
        "top_p": 1.0,
    },
    {
        "name": "é»˜è®¤-åˆ†ç±»",
        "type": "classification",
        "prompt": """è¯·æ ¹æ®ä»¥ä¸‹æ–‡ç« å†…å®¹ä¸Žåˆ†ç±»åˆ—è¡¨é€‰æ‹©æœ€åŒ¹é…çš„åˆ†ç±»ã€‚

ç¡¬æ€§è¦æ±‚ï¼š
1) ä»…è¾“å‡ºåˆ†ç±» IDï¼ˆUUIDï¼‰ï¼Œä¸è¦è¾“å‡ºä»»ä½•è§£é‡Šæˆ–å¤šä½™å­—ç¬¦ã€‚
2) è‹¥æ— åˆé€‚åˆ†ç±»è¾“å‡ºç©ºå­—ç¬¦ä¸²ã€‚
3) åªå…è®¸è¾“å‡ºåˆ†ç±»åˆ—è¡¨ä¸­å‡ºçŽ°çš„ IDã€‚

åˆ†ç±»åˆ—è¡¨ï¼š
{categories}

æ–‡ç« å†…å®¹ï¼š
{content}""",
        "system_prompt": "ä½ æ˜¯å†…å®¹åˆ†ç±»åŠ©æ‰‹ï¼Œåªè¾“å‡ºåˆ†ç±» IDã€‚",
        "response_format": "text",
        "temperature": 0.1,
        "max_tokens": 200,
        "top_p": 0.9,
    },
    {
        "name": "é»˜è®¤-å†…å®¹æ ¡éªŒ",
        "type": "content_validation",
        "prompt": """ä½ æ˜¯å†…å®¹è´¨æ£€å‘˜ï¼Œåªè¾“å‡º JSONã€‚

ç¡¬æ€§è¦æ±‚ï¼š
1) ä»…è¾“å‡º JSONï¼Œä¸è¦è§£é‡Š/Markdown ä»£ç å—ã€‚
2) JSON ç»“æž„ï¼š{"is_valid": true/false, "error": "é”™è¯¯åŽŸå› "}ã€‚
3) è‹¥åˆè§„ï¼šis_valid=trueï¼Œerror ä¸ºç©ºå­—ç¬¦ä¸²ã€‚
4) è‹¥ä¸åˆè§„ï¼šis_valid=falseï¼Œerror ä½¿ç”¨â€œé”™è¯¯ç±»åž‹ï¼šè¯´æ˜Žâ€æ ¼å¼ï¼Œé”™è¯¯ç±»åž‹ä»…é™ä»¥ä¸‹ä¹‹ä¸€ï¼šç©ºå†…å®¹ã€å¹¿å‘Š/å¯¼èˆªã€ç»“æž„æ··ä¹±ã€æ ¼å¼å¼‚å¸¸ã€è¯­è¨€æ··æ‚ã€å…¶ä»–ã€‚
5) åˆè§„æ ‡å‡†ï¼šå¿…é¡»åŒ…å«æ­£æ–‡å†…å®¹ï¼›æ ‡é¢˜/æ®µè½æ ¼å¼åˆç†ï¼›æ— æ˜Žæ˜¾å¹¿å‘Š/å¯¼èˆªï¼›æ— ç©ºè¾“å‡ºã€‚

å¾…æ ¡éªŒå†…å®¹ï¼š
{content}""",
        "system_prompt": "ä½ æ˜¯å†…å®¹è´¨æ£€å‘˜ï¼Œåªè¾“å‡º JSONã€‚",
        "response_format": "json_object",
        "temperature": 0.0,
        "max_tokens": 800,
        "top_p": 1.0,
    },
    {
        "name": "é»˜è®¤-å†…å®¹æ¸…æ´—",
        "type": "content_cleaning",
        "prompt": """è¯·å°†ä»¥ä¸‹ HTML å†…å®¹æ¸…æ´—ä¸ºç»“æž„åŒ–çš„ GFM Markdownã€‚

ç¡¬æ€§è¦æ±‚ï¼š
1) ä»…è¾“å‡º Markdown æ­£æ–‡ï¼Œç¦æ­¢ä»»ä½•è§£é‡Š/å‰åŽç¼€ã€‚
2) å¿…é¡»ä¿ç•™ï¼šæ ‡é¢˜å±‚çº§ã€åˆ—è¡¨ã€å¼•ç”¨ã€è¡¨æ ¼ã€é“¾æŽ¥ã€å›¾ç‰‡ã€ä»£ç å—ã€æ®µè½æ¢è¡Œã€‚
3) å¿…é¡»åŽ»é™¤ï¼šå¯¼èˆªã€å¹¿å‘Šã€ç‰ˆæƒå£°æ˜Žã€æŽ¨èé˜…è¯»ã€åˆ†äº«æŒ‰é’®ã€è¯„è®ºåŒºã€ç›¸å…³é“¾æŽ¥ã€é¡µè„šã€‚
4) ä¸è¦æ”¹å†™å†…å®¹ï¼Œåªåšç»“æž„åŒ–ä¸ŽåŽ»å™ªã€‚
5) é“¾æŽ¥ä½¿ç”¨æ ‡å‡† Markdown å½¢å¼ï¼Œå›¾ç‰‡ä½¿ç”¨ ![]()ã€‚
6) è‹¥å†…å®¹ä¸­åŒ…å«è§†é¢‘/éŸ³é¢‘ï¼Œå¿…é¡»ä¿ç•™å…¶é“¾æŽ¥ï¼›è§†é¢‘ä½¿ç”¨ [â–¶ æ ‡é¢˜](URL)ï¼ŒéŸ³é¢‘ä½¿ç”¨ [ðŸŽ§ æ ‡é¢˜](URL)ã€‚
7) è‹¥å†…å®¹ä¸­åŒ…å«æ•°å­¦å…¬å¼ï¼Œå¿…é¡»å®Œæ•´ä¿ç•™ï¼Œä¸å¾—æ”¹å†™ï¼›è¡Œå†…å…¬å¼ä½¿ç”¨ $...$ï¼Œç‹¬ç«‹å…¬å¼ä½¿ç”¨ $$...$$ã€‚

HTMLï¼š
{content}""",
        "system_prompt": "ä½ æ˜¯ä¸¥è°¨çš„å†…å®¹æ¸…æ´—ä¸“å®¶ï¼Œä¸“æ³¨è¾“å‡ºç¨³å®šã€ç»“æž„åŒ–çš„ GFM Markdownã€‚",
        "response_format": "text",
        "temperature": 0.1,
        "max_tokens": 12000,
        "top_p": 1.0,
    },
]


INSERT_SQL = text(
    """
    INSERT INTO prompt_configs (
        id,
        name,
        category_id,
        type,
        prompt,
        system_prompt,
        response_format,
        temperature,
        max_tokens,
        top_p,
        model_api_config_id,
        is_enabled,
        is_default,
        created_at,
        updated_at
    ) VALUES (
        :id,
        :name,
        NULL,
        :type,
        :prompt,
        :system_prompt,
        :response_format,
        :temperature,
        :max_tokens,
        :top_p,
        NULL,
        1,
        1,
        :created_at,
        :updated_at
    )
    """
)


def upgrade() -> None:
    bind = op.get_bind()
    existing_count = bind.execute(text("SELECT COUNT(*) FROM prompt_configs")).scalar()
    if existing_count and int(existing_count) > 0:
        return

    today = date.today().isoformat()
    for item in DEFAULT_PROMPT_CONFIGS:
        bind.execute(
            INSERT_SQL,
            {
                "id": str(uuid.uuid4()),
                "name": item["name"],
                "type": item["type"],
                "prompt": item["prompt"],
                "system_prompt": item["system_prompt"],
                "response_format": item["response_format"],
                "temperature": item["temperature"],
                "max_tokens": item["max_tokens"],
                "top_p": item["top_p"],
                "created_at": today,
                "updated_at": today,
            },
        )


def downgrade() -> None:
    bind = op.get_bind()
    for item in DEFAULT_PROMPT_CONFIGS:
        bind.execute(
            text(
                """
                DELETE FROM prompt_configs
                WHERE category_id IS NULL
                  AND is_default = 1
                  AND model_api_config_id IS NULL
                  AND type = :type
                  AND name = :name
                """
            ),
            {"type": item["type"], "name": item["name"]},
        )
